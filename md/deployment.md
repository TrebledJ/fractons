###### Last Updated: Thursday, April 4, 2019

# Deploying

### Navigate to the Project File (.pro extension)
Follow the guidance on the `.pro` file automatically generated by Felgo.

1. comment the `DEPLOYMENTFOLDERS += qmlFolder` line above, to avoid shipping your qml files with the application (instead they get compiled to the app binary)
2. uncomment the `resources.qrc` file inclusion and **add any qml subfolders to the .qrc file**; this compiles your qml files and js files to the app binary and protects your source code
3. change the `setMainQmlFile()` call in `main.cpp` to the one starting with `"qrc:/"` - this loads the qml files from the resources

Also comment out any instances and includes of Felgo's Live Client.

### Change the Build to *Release* Mode

### Clean and Build Once

### Delete all files/folders from `application.app/Contents/Resources`.

Leave behind `./assets/sounds` folder and `./app_icons.icns`.

### Use the `macdeployqt` Terminal Utility

When deploying, use the `macdeployqt` executable tool. Run the following from the command line, replacing appropriately.

	macdeployqt <ApplicationName>.app -qmldir=<Path-to-QMLs>
	
To deploy as a disk-mounted image, add the `-dmg` flag:

	macdeployqt <ApplicationName>.app -dmg -qmldir=<Path-to-QMLs>

Specifically, this was the command I runned after `cd`ing to the shadow build directory.

	cd `dirname /Users/JLAW/Documents/BitBucket/build-Fractureuns-V_Play_Desktop_Qt_5_11_1_clang-Release/Fractureuns.app`
	macdeployqt Fractureuns.app -qmldir=/Users/JLAW/Documents/BitBucket/Fractureuns/src/qml -dmg

### Delete all frameworks except for the relevant ones:

* QtCharts
* QtCore
* QtGui
* QtMultimedia
* QtMultimediaQuick
* QtMultimediaWidgets
* QtNetwork
* QtOpenGL
* QtPrintSupport
* QtQml
* QtQuick
* QtQuickControls2
* QtQuickTemplates2
* QtSql
* QtWebSockets
* QtWidgets

### Delete all plugins except for the relevant ones:

* audio
* mediaservice/libqavfmediaplayer.dylib
* mediaservice/libqtmedia_audioengine.dylib
* platforms
* quick
* sqldrivers/libqsqlite.dylib

### Delete all folders from `Resources/qml` except for the relevant ones:

* Felgo
* Qt
* QtCharts
* QtGraphicalEffects
* QtMultimedia
* QtQml
* QtQuick
* QtQuick.2
* VPlay

### Create a Disk Image using Disk Utility

* Copy your app to a **new folder** (<kbd>⌘</kbd>+<kbd>Shift</kbd>+<kbd>N</kbd>).
* Open Disk Utility → File → New Image → Image From Folder.
* Select the folder where you have placed the App. Give a name for the DMG and save. This creates a distributable image for you.

[Source](https://stackoverflow.com/questions/37292756/how-to-create-a-dmg-file-for-a-app-for-mac)



# Publishing

When publishing, the project stage needs to be changed from `"test"` to `"publish"` in the `config.json` file under the `qml` subfolder.

For projects with multiple developers or plugins, a [license key](https://felgo.com/developers/license) is recommended and needs to be set on the root parent widget ([`App::licenseKey`](https://felgo.com/doc/felgo-app/#licenseKey-prop) or [`GameWindow::licenseKey`](https://felgo.com/doc/felgo-gamewindowitem/#licenseKey-prop)).

Publishing on the App Store and Google Play needs to be licensed (requires payment).


For more info, see [Deploy Felgo Games and Apps](https://felgo.com/doc/felgo-deployment/) and [Publish Felgo Games and Apps](https://felgo.com/doc/felgo-publishing/).